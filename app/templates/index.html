{% extends "base.html" %}

{% block content %}
<h1>ğŸ“š DynamoDB Learning Blog</h1>

<div class="container">
    <div class="main-content">
        <h2>ãƒ–ãƒ­ã‚°æŠ•ç¨¿</h2>
        {% for post in posts %}
        <div class="card post-card" onclick="location.href='/post/{{ post.id }}'">
            <h3>{{ post.title }}</h3>
            <p>{{ post.content[:150] }}...</p>
            <div class="stats">
                <span>ğŸ‘¤ {{ post.author }}</span>
                <span>ğŸ“… {{ post.created_at.strftime('%Y-%m-%d') }}</span>
            </div>
        </div>
        {% endfor %}
        {% if posts|length == 0 %}
        <p>æŠ•ç¨¿ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
        {% endif %}
    </div>

    <div class="sidebar">
        <h2>ğŸ¯ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</h2>
        <div class="activity-feed" hx-get="/activities/feed" hx-trigger="every 5s" hx-swap="innerHTML">
            {% for activity in recent_activities %}
            <div class="activity-item">
                <strong>{{ activity.activity_type }}</strong>
                <span class="timestamp">{{ activity.user_id[:8] }}...</span>
                {% if activity.post_id != 'none' %}
                <br>æŠ•ç¨¿ID: {{ activity.post_id }}
                {% endif %}
            </div>
            {% endfor %}
        </div>

        <div style="margin-top: 20px;">
            <button hx-get="/activities/feed?activity_type=view" hx-target=".activity-feed">
                é–²è¦§å±¥æ­´
            </button>
            <button hx-get="/activities/feed?activity_type=like" hx-target=".activity-feed">
                ã„ã„ã­
            </button>
            <button hx-get="/activities/feed?activity_type=comment" hx-target=".activity-feed">
                ã‚³ãƒ¡ãƒ³ãƒˆ
            </button>
        </div>
    </div>
</div>
{% endblock %}