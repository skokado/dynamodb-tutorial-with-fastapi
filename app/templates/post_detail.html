{% extends "base.html" %}

{% block content %}
<h1>ğŸ“– {{ post.title }}</h1>

<div class="container">
    <div class="main-content">
        <div class="card">
            <div class="stats">
                <span>ğŸ‘¤ {{ post.author }}</span>
                <span>ğŸ“… {{ post.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
            </div>

            <div style="margin: 20px 0; line-height: 1.8;">
                {{ post.content }}
            </div>

            <div style="margin: 20px 0;">
                <button hx-post="/post/{{ post.id }}/like" hx-target="this" hx-swap="outerHTML"
                    class="like-btn {{ 'liked' if has_liked else '' }}">
                    {{ 'â¤ï¸' if has_liked else 'ğŸ¤' }} {{ like_count }}
                </button>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ’¬ ã‚³ãƒ¡ãƒ³ãƒˆ</h3>

            <form hx-post="/post/{{ post.id }}/comment" hx-target="#comments" hx-swap="beforeend">
                <textarea name="content" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›..."
                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required></textarea>
                <button type="submit"
                    style="margin-top: 10px; padding: 8px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
                    ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿
                </button>
            </form>

            <div id="comments" style="margin-top: 20px;">
                {% for comment in comments %}
                <div class="comment">
                    <div class="comment-header">
                        {{ comment.user_id[:8] }}... -
                        {{ comment.timestamp }}
                    </div>
                    <div class="comment-content">{{ comment.content }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="sidebar">
        <div class="card">
            <h3>ğŸ“Š ã“ã®æŠ•ç¨¿ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</h3>
            <div class="activity-feed">
                {% for activity in activities %}
                <div class="activity-item">
                    <strong>{{ activity.activity_type }}</strong>
                    <br>
                    <span class="timestamp">
                        User: {{ activity.user_id[:8] }}...
                    </span>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="card" style="margin-top: 20px;">
            <h3>ğŸ“ˆ çµ±è¨ˆæƒ…å ±</h3>
            <p>ğŸ‘ï¸ é–²è¦§æ•°: {{ activities|length }}</p>
            <p>â¤ï¸ ã„ã„ã­: {{ like_count }}</p>
            <p>ğŸ’¬ ã‚³ãƒ¡ãƒ³ãƒˆ: {{ comments|length }}</p>
        </div>

        <div style="margin-top: 20px;">
            <a href="/" style="text-decoration: none; color: #007bff;">â† ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
        </div>
    </div>
</div>
{% endblock %}